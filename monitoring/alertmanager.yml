global:
  resolve_timeout: 5m

# Email configuration (optional - configure SMTP)
# smtp_smarthost: 'smtp.gmail.com:587'
# smtp_from: 'alerts@reviewsignal.ai'
# smtp_auth_username: 'your-email@gmail.com'
# smtp_auth_password: 'your-app-password'

route:
  # Default receiver
  receiver: 'slack-critical'

  # Group alerts by these labels
  group_by: ['alertname', 'cluster', 'service']

  # Wait before sending notification
  group_wait: 30s

  # Wait before sending about new alerts in group
  group_interval: 5m

  # Wait before re-sending notification
  repeat_interval: 4h

  # Route specific alerts to specific receivers
  routes:
    - match:
        severity: critical
      receiver: slack-critical
      continue: true

    - match:
        severity: warning
      receiver: slack-warnings
      continue: true

    - match:
        alertname: LeadReceiverDown
      receiver: slack-critical
      continue: true

    - match:
        alertname: PostgreSQLDown
      receiver: slack-critical
      continue: true

receivers:
  # Slack - Critical Alerts (Configure webhook URL after deployment)
  - name: 'slack-critical'
    # Uncomment and configure after deployment:
    # slack_configs:
    #   - api_url: 'https://hooks.slack.com/services/YOUR/WEBHOOK/URL'
    #     channel: '#reviewsignal-alerts'
    #     title: 'üö® CRITICAL: {{ .GroupLabels.alertname }}'
    #     text: |
    #       *Alert:* {{ .GroupLabels.alertname }}
    #       *Severity:* {{ .CommonLabels.severity }}
    #       *Description:* {{ .CommonAnnotations.description }}
    #       *Service:* {{ .CommonLabels.service }}
    #       *Time:* {{ .CommonAnnotations.summary }}
    #     send_resolved: true

  # Slack - Warning Alerts (Configure webhook URL after deployment)
  - name: 'slack-warnings'
    # Uncomment and configure after deployment:
    # slack_configs:
    #   - api_url: 'https://hooks.slack.com/services/YOUR/WEBHOOK/URL'
    #     channel: '#reviewsignal-warnings'
    #     title: '‚ö†Ô∏è WARNING: {{ .GroupLabels.alertname }}'
    #     text: |
    #       *Alert:* {{ .GroupLabels.alertname }}
    #       *Description:* {{ .CommonAnnotations.description }}
    #       *Service:* {{ .CommonLabels.service }}
    #     send_resolved: true

  # Email alerts (optional)
  # - name: 'email'
  #   email_configs:
  #     - to: 'team@reviewsignal.ai'
  #       from: 'alerts@reviewsignal.ai'
  #       smarthost: smtp.gmail.com:587
  #       auth_username: 'your-email@gmail.com'
  #       auth_password: 'your-app-password'
  #       headers:
  #         Subject: '[ReviewSignal] {{ .GroupLabels.alertname }}'

  # Webhook (for custom integrations)
  # - name: 'webhook'
  #   webhook_configs:
  #     - url: 'http://your-webhook-endpoint/alerts'
  #       send_resolved: true

# Inhibition rules (prevent duplicate alerts)
inhibit_rules:
  - source_match:
      severity: 'critical'
    target_match:
      severity: 'warning'
    equal: ['alertname', 'instance']
